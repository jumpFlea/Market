<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qst.dao.ShopCarDAO1">

    <!--将获取到的g_id,uid 插入到 购物车中 -->
    <insert id="addToCart" parameterType="ShopCartGoods" >
        insert into shopcar_goods (g_id,u_id,goods_number,price)
        values ( #{gid},#{uid},#{goods_number},#{price});
    </insert>

    <!--通过用户id 查找商品id 从购物车中  -->
    <select id="getGoodsByUserId" parameterType="int" resultType="hashmap">
        select
            s.g_id AS gid,
            s.price AS price,
            s.goods_number AS `number`,
            g.g_name AS goodsName,
            g.image_zhanshi AS imageSrc,
            g.g_attribute AS attribute
        from shopcar_goods s
            LEFT JOIN goods g ON s.g_id = g.g_id
        where s.u_id=#{id} ;
    </select>

    <!--通过用户id 查找商品id 从购物车中  -->
    <select id="ifExist" parameterType="ShopCartGoods" resultType="integer">
        select sg_id from shopcar_goods
        where u_id=#{uid} and g_id=#{gid};
    </select>

    <update id="update" parameterType="ShopCartGoods">
        UPDATE shopcar_goods
        SET
            goods_number=#{goods_number},
            price=#{price}
        where sg_id=#{id};
    </update>

    <select id="getCountByUser" parameterType="integer" resultType="integer">
        SELECT count(*) FROM shopcar_goods WHERE u_id=#{uid};
    </select>

</mapper>